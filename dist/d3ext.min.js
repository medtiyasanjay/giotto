!function(){"use strict";var a={version:"0.1.0"},b=/xyz/.test(function(){})?/\b_super\b/:/.*/,c=function(a,c,d,e){return"function"==typeof d&&"function"==typeof e[c]&&b.test(d)?a.new_attr(c,function(){var a=this._super;this._super=e[c];var b=d.apply(this,arguments);return this._super=a,b}):a.new_attr(c,d)},d=a.Type=function(a){return a.new_class=function(a,b){var d=this,e=a===d,f=e?a:a.prototype;a.initialising=!0;var g=new a;delete a.initialising;for(var h in b)"Metaclass"!==h&&(g[h]=c.call(a,d,h,b[h],f));if(e){for(h in f)void 0===g[h]&&(g[h]=f[h]);return g}var i=function(){!this.constructor.initialising&&this.init&&this.init.apply(this,arguments)};return i.prototype=g,i.prototype.constructor=i,i.extend=a.extend,i},a.new_attr=function(a,b){return b},a.extend=function(b){return a.new_class(this,b)},a}(function(){}),e=a.Class=function(a){return a.__class__=d,a.extend=function(a){var b=a.Metaclass||this.__class__,c=b.new_class(this,a);return c.__class__=b,c},a}(function(){}),f=a.Viz=e.extend({init:function(a,b,c){a=$(a),this.element=a,this.attrs=b||(b={}),this.$lux=c,this.elwidth=null,this.elheight=null,this.d3=null;var d=this.element.parent();if(b.width?b.width=+b.width:(b.width=a.width(),b.width?this.elwidth=a:(b.width=d.width(),b.width?this.elwidth=d:b.width=400)),b.height?b.height.indexOf("%")===b.height.length-1&&(b.height_percentage=.01*parseFloat(b.height),b.height=b.height_percentage*b.width):(b.height=a.height(),b.height?this.elheight=a:(b.height=d.height(),b.height?this.elheight=d:b.height=400)),b.resize){var e=this;$(window).resize(function(){e.resize()})}this.build()},resize:function(a){var b,c;a?(b=a[0],c=a[1]):(b=this.elwidth?this.elwidth.width():this.attrs.width,c=this.attrs.height_percentage?b*this.attrs.height_percentage:this.elheight?this.elheight.height():this.attrs.height),(this.attrs.width!==b||this.attrs.height!==c)&&(this.attrs.width=b,this.attrs.height=c,this.build())},svg:function(){return this.element.empty(),this.d3.select(this.element[0]).append("svg").attr("width",this.attrs.width).attr("height",this.attrs.height)},size:function(){return[this.attrs.width,this.attrs.height]},sy:function(){var a=this.size();return a[1]/a[0]},build:function(a){if(a&&(this.attrs=$.extend(this.attrs,a)),this.d3)this.d3build();else{var b=this;require(["d3"],function(a){b.d3=a,b.d3build()})}},d3build:function(){}});a.vizDirectiveFactory=function(a){return[function(){return{restrict:"AE",link:function(b,c,d){new a(c,d)}}}]},a.SunBurst=f.extend({d3build:function(){function a(a){k.transition().duration(750).attrTween("d",b(a))}function b(a){var b=d.interpolate(x.domain(),[a.x,a.x+a.dx]),c=d.interpolate(y.domain(),[a.y,1]),e=d.interpolate(y.range(),[a.y?20:0,radius]);return function(a,d){return d?function(){return j(a)}:function(d){return x.domain(b(d)),y.domain(c(d)).range(e(d)),j(a)}}}if(!this.root){var c=this;return d.json(this.attrs.target,function(a,b){a||(c.root=b||{},c.d3build())})}var d=this.d3,e=this.size(),f=this.root,g=e[0],h=e[1],i=this.svg().append("g").attr("transform","translate("+g/2+","+(h/2+10)+")");color=d.scale.category20c(),partition=d.layout.partition().value(function(a){return a.size});var j=d.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,x(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,x(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,y(a.y))}).outerRadius(function(a){return Math.max(0,y(a.y+a.dy))}),k=i.selectAll("path").data(partition.nodes(f)).enter().append("path").attr("d",j).style("fill",function(a){return color((a.children?a:a.parent).name)}).on("click",a)}}),"function"==typeof define&&define.amd?define(a):"object"==typeof module&&module.exports?module.exports=a:window.d3ext=a}();