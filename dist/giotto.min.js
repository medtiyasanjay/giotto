!function(a){var b;b="object"==typeof module&&module.exports?module.exports:window,"function"==typeof define&&define.amd?define(["d3"],function(){return a(d3,b)}):"object"==typeof module&&module.exports&&a(d3,b)}(function(a,b){"use strict";function c(){}function d(a){return h(a,"width")}function e(a){return h(a,"height")}function f(a){return i(a,"width")}function g(a){return i(a,"height")}function h(a,b){for(var c,d=a.node();d&&"BODY"!==d.tagName&&!(c=d.getBoundingClientRect()[b]);)d=d.parentNode;return c}function i(b,c){for(var d,e=b.node();e&&"BODY"!==e.tagName;){if(d=e.getBoundingClientRect()[c])return a.select(e);e=e.parentNode}}function j(b,c){n.paper[c.type](b,c);var d=b.innerWidth(),e=b.innerHeight(),f=[{axis:b.xAxis(),o:c.xaxis,range:[0,d]},{axis:b.yaxis(2).yAxis(),o:c.yaxis2,range:[e,0]},{axis:b.yaxis(1).yAxis(),o:c.yaxis,range:[e,0]}];return f.forEach(function(a){var b=a.axis,c=a.o;b.orient(c.position).scale().range(a.range),null!==c.min&&null!==c.max?b.scale().domain([c.min,c.max]):c.auto=!0}),c.css&&A("#giotto-paper-"+b.uid(),c.css),a.rebind(b,c.event,"on")}function l(b,c){var h,i;c?(h=c.width,i=c.height,c=u(c,function(a,b){return void 0!==n.defaults.paper[b]?a:void 0})):c={};var j=r(!0,{},n.defaults.paper,c);return h||(h=d(b),h?j.elwidth=f(b):h=n.constants.WIDTH),i?"string"==typeof i&&i.indexOf("%")===i.length-1&&(j.height_percentage=.01*parseFloat(i),i=a.round(j.height_percentage*h)):(i=e(b),i?j.elheight=g(b):i=n.constants.HEIGHT),j.size=[h,i],j.event=a.dispatch("refresh"),j}var m={version:"0.1.0",d3:a,math:{}},n=m;a.giotto=m,a.canvas={},n.require=function(a,c){return b.rcfg&&b.rcfg.min&&(a=b.rcfg.min(a)),require(a,c),n},n.angular={module:function(a,b,c){return n.angular._module||(b=b||"giotto",c=c||[],n.angular._module=a.module(b,c).directive("jstats",function(){return{link:function(b,c,d){var e=d.mode?+d.mode:1;require(rcfg.min(["stats"]),function(){var d=new Stats;d.setMode(e),b.stats=d,c.append(a.element(d.domElement))})}}})),n.angular._module},directive:function(a,b,c){var d=n.angular._module;return d||n.log.warning("No angular module, cannot add directive"),c=c?c.slice():[],b||(b=a.vizName(),b=d.name.toLowerCase()+b.substring(0,1).toUpperCase()+b.substring(1)),c.push(function(){return{restrict:"AE",link:function(c,d,e){var f=d.data(b);if(!f){var g=t(e);g.scope=c,f=a(d[0],g),d.data(b,f),c.$emit("giotto-viz",f),f.start()}}}}),d.directive(b,c)},addAll:function(a,b){n.angular.module(a),n.log.info("Adding giotto visualization directives"),a.forEach(n.viz,function(a){n.angular.directive(a,null,b)})}};var o=function(a){function b(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function d(a){var d=window.console||{},e=d[a]||d.log||c,f=!1;try{f=!!e.apply}catch(g){}return f?function(){for(var a=[],c=0;c<arguments.length;++c)a.push(b(arguments[c]));return e.apply(d,a)}:function(a,b){e(a,null===b?"":b)}}return{log:d("log"),info:d("info"),warn:d("warn"),error:d("error"),debug:function(){var b=d("debug");return function(){a&&b.apply(self,arguments)}}()}};n.log=o(b.debug);var p=Object.prototype.toString,q=n._={},r=n.extend=q.extend=function(){var a,b=arguments.length,c=arguments[0],d=0,e=!1;if(c===!0&&(e=!0,c=arguments[1],d++),!c||d+2>b)return c;for(;++d<b;)if(a=arguments[d],Object(a)===a)for(var f in a)a.hasOwnProperty(f)&&(e&&q.isObject(a[f])?q.isObject(c[f])?r(!0,c[f],a[f]):c[f]=r(!0,{},a[f]):c[f]=a[f]);return c},s=q.copyMissing=function(a,b){if(a&&b)for(var c in a)a.hasOwnProperty(c)&&void 0===b[c]&&(b[c]=a[c]);return b},t=function(a){if(a&&"string"==typeof a.options){for(var c=b,d=a.options.split("."),e=0;e<d.length&&(c=c[d[e]],c);++e);"function"==typeof c&&(c=c(n,a)),a=r(a,c)}return a},u=(q.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},q.size=function(a){if(a){if(void 0!==a.length)return a.length;if(q.isObject(a)){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b}return 0}return 0},q.pick=function(a,b){var c,d={};for(var e in a)a.hasOwnProperty(e)&&(c=b(a[e],e),void 0!==c&&(d[e]=c));return d}),v=q.isObject=function(a){return"[object Object]"===p.call(a)},w=(q.isString=function(a){return"[object String]"===p.call(a)},q.isFunction=function(a){return"[object Function]"===p.call(a)}),x=q.isArray=function(a){return"[object Array]"===p.call(a)},y=q.encodeObject=function(a,b){var c;if("multipart/form-data"===b){var d=new FormData;for(c in a)a.hasOwnProperty(c)&&d.append(c,a[c]);return d}if("application/json"===b)return JSON.stringify(a);var e=[];for(c in a)a.hasOwnProperty(c)&&e.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return e.join("&")},z=q.getObject=function(a){if(q.isString(a)){var c=a.split(".");a=b;for(var d=0;d<c.length&&(a=a[c[d]],a);++d);}return a},A=(q.loadCss=function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css"),b.setAttribute("href",a),document.getElementsByTagName("head")[0].appendChild(b)},q.addCss=function(a,b){function c(a,b){var e,f=[];for(var g in b)b.hasOwnProperty(g)&&(e=b[g],q.isObject(e)?c(a+" ."+g,e):f.push("    "+g+": "+e+";"));f.length&&d.push(a+" {\n"+f.join("\n")+"\n}")}var d=[];if(c(a,b),d.length){d=d.join("\n");var e=document.createElement("style");return e.innerHTML=d,document.getElementsByTagName("head")[0].appendChild(e),e}});n.defaults={},n.defaults.axis={color:"#000",tickSize:.05,minTickSize:null,min:null,max:null},n.defaults.paper={type:"svg",resizeDelay:200,resize:!0,margin:{top:20,right:20,bottom:20,left:20},xaxis:r({position:"bottom"},n.defaults.axis),yaxis:r({position:"left"},n.defaults.axis),yaxis2:r({position:"right"},n.defaults.axis),colors:a.scale.category10().range(),css:null,line:{interpolate:"basis",width:2},point:{symbol:"circle",size:8,fill:!0,fillOpacity:.5,width:1},bar:{width:"auto",stroke:"none",radius:4},font:{size:11,weight:"bold",lineHeight:13,style:"italic",family:"sans-serif",variant:"small-caps"}},n.defaults.viz=r({onInit:null,events:["build","change","start","tick","end"]}),n.constants={DEFAULT_VIZ_GROUP:"default_viz_group",WIDTH:400,HEIGHT:300,leaflet:"http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"};var B=0;n.paper=function(b,c){var f,g,h,i,k={},m=++B;return v(b)&&(c=b,b=null),b||(b=document.createElement("div")),b=a.select(b),c=l(b,c),k.type=function(){return c.type},k.uid=function(){return m},k.size=function(){return[c.size[0],c.size[1]]},k.width=function(){return c.size[0]},k.height=function(){return c.size[1]},k.innerWidth=function(){return c.size[0]-c.margin.left-c.margin.right},k.innerHeight=function(){return c.size[1]-c.margin.top-c.margin.bottom},k.aspectRatio=function(){return k.innerHeight()/k.innerWidth()},k.element=function(){return b},k.yaxis=function(a){return arguments.length?((1===a||2===a)&&(c.yaxisNumber=a),k):c.yaxisNumber},k.xAxis=function(){return c.xAxis},k.yAxis=function(){return c.yAxis[c.yaxisNumber-1]},k.scale=function(a){var b=c.xAxis.scale();return b(a)-b(0)},k.scalex=function(a){return c.xAxis.scale()(a)},k.scaley=function(a){return k.yAxis().scale()(a)},k.resize=function(a){c._resizing=!0,a||(a=k.boundingBox()),(c.size[0]!==a[0]||c.size[1]!==a[1])&&(n.log.info("Resizing paper"),c.size=a,k.refresh()),c._resizing=!1},k.x=function(a){var b=k.xAxis().scale().domain();return a*(b[b.length-1]-b[0])+b[0]},k.y=function(a){var b=k.yAxis().scale().domain();return a*(b[b.length-1]-b[0])+b[0]},k.boundingBox=function(){var b,f=c.elwidth?d(c.elwidth):c.size[0];return b=c.height_percentage?a.round(f*c.height_percentage,0):c.elheight?e(c.elheight):c.size[1],[f,b]},k.xyData=function(a){if(a){a.data||(a={data:a});var b=a.data,c=1/0,d=1/0,e=-1/0,f=-1/0,g=function(a){return c=c>a?a:c,e=a>e?a:e,a},h=function(a){return d=d>a?a:d,f=a>f?a:f,a},i=[];if(x(b[0])&&2===b[0].length)b.forEach(function(a){i.push({x:g(a[0]),y:h(a[1])})});else{var j=a.xlabel||"x",k=a.ylabel||"y";b.forEach(function(a){i.push({x:g(a[j]),y:h(a[k])})})}return a.data=i,a.xrange=[c,e],a.yrange=[d,f],a}},k.pickColor=function(){var a=c.colors[i++];return i===c.colors.length&&(i=0),a},k.addComponent=function(a){var b=++h;f.push(a),g[b]=a;var c=a();return c||(c={}),c.cid=b,c},k.removeComponent=function(a){if(a){var b=g[a];if(b){delete g[a];var c=f.indexOf(b);if(c>-1)return f.splice(c,1)[0]}}},k.render=function(a){arguments.length?g[a]&&g[a]():f.forEach(function(a){a()})},k.clear=function(){return f=[],g={},h=0,i=0,k},k.options=function(){return c},c.resize&&a.select(window).on("resize.paper",function(){c._resizing||(c.resizeDelay?(c._resizing=!0,a.timer(function(){return k.resize(),!0},c.resizeDelay)):k.resize())}),j(k,c)},n.paper.addType=function(a,b){var c=[];n.paper[a]=function(a,d){b(a,d);for(var e=0;e<c.length;++e)c[e](a,d);return a},n.paper[a].plugin=function(a,b,d){n.defaults.paper[a]=b,c.push(d)}},n.paper.addType("svg",function(b,c){function d(a,c,d,f,g){var h=(g.font,b.root().current().select("g."+c));h.node()||(h=e(b.current().append("g").attr("class","axis "+c).attr("transform","translate("+d+","+f+")").attr("stroke",g.color),g.font),b.addComponent(function(){h.call(a)}))}function e(a,b){var d=c.font;return b||(b={}),a.style({"font-size":b.size||d.size,"font-weight":b.weight||d.weight,"font-style":b.style||d.style,"font-family":b.family||d.family,"font-variant":b.variant||d.variant})}var f,g=b.element().append("svg").attr("class","giotto").attr("id","giotto-paper-"+b.uid()).attr("width",c.size[0]).attr("height",c.size[1]).attr("viewBox","0 0 "+c.size[0]+" "+c.size[1]),h=b.clear;c.xAxis=a.svg.axis(),c.yAxis=[a.svg.axis(),a.svg.axis()],b.destroy=function(){g=f=null,b.element().selectAll("*").remove()},b.refresh=function(){return g.attr("width",c.size[0]).attr("height",c.size[1]),c.event.refresh({type:"refresh",size:c.size.slice(0)}),b},b.clear=function(){return g.selectAll("*").remove(),f=g.append("g").attr("transform","translate("+c.margin.left+","+c.margin.top+")").attr("class","paper"),h()},b.current=function(){return f},b.root=function(){return f=g.select("g.paper"),b},b.parent=function(){var c=f.node().parentNode;return c!==g.node()&&(f=a.select(c)),b},b.group=function(){return f=f.append("g")},b.circle=function(a,c,d){return a=b.scalex(a),c=b.scaley(c),d=b.scale(d),f.append("circle").attr("cx",a).attr("cy",c).attr("r",d)},b.rect=function(a,c,d,e,g){var h=b.scalex(a),i=b.scaley(c);d=b.scalex(a+d)-h,e=b.scalex(c+e)-i;var j=f.append("rect").attr("x",h).attr("y",i).attr("width",d).attr("height",e);if(g){{var k=b.scalex(g)-b.scalex(0);b.scaley(g)-b.scaley(0)}j.attr("rx",k).attr("ry",rt)}return j},b.path=function(d,e){e||(e={}),s(c.line,e),e.color=e.color||b.pickColor();var g=f;return b.addComponent(function(){var c=g.select("path.line"),h=b.scalex,i=b.scaley,j=e.area?a.svg.area():a.svg.line();return j.interpolate(e.interpolate).x(function(a){return h(a.x)}).y(function(a){return i(a.y)}),c.node()||(c=f.append("path").attr("class","line")),c.classed("area",e.area).attr("stroke",e.color).attr("stroke-width",e.width).datum(d).attr("d",j),e.chart=c,e})},b.points=function(d,e){e||(e={}),s(c.point,e),e.color=e.color||b.pickColor();var g=f;return b.addComponent(function(){function c(a,b){return void 0===a?b:k(a)}var f,h=g.select("g.points"),i=b.scalex,j=b.scaley,k=b.scale,l=e.fill;if(l===!0&&(e.fill=l=a.rgb(e.color).brighter()),h.node()?f=h.selectAll("circle.point"):(h=g.append("g").attr("class","points"),"circle"===e.symbol?f=h.selectAll("circle.point").data(d).enter().append("circle").attr("class","point"):"square"===e.symbol&&(f=h.selectAll("rect.point").data(d).enter().append("rect")),f.attr("class","point")),h.attr("stroke",e.color).attr("stroke-width",e.width),l?h.attr("fill",l).attr("fill-opacity",e.fillOpacity):h.attr("fill","none"),"circle"===e.symbol){var m=.5*e.size;f.attr("cx",function(a){return i(a.x)}).attr("cy",function(a){return j(a.y)}).attr("r",function(a){return c(a.radius,m)}).style("fill",function(a){return a.fill})}else if("square"===e.symbol){var n=e.size;f.attr("x",function(a){return i(a.x)-.5*c(a.size,n)}).attr("y",function(a){return j(a.y)-.5*c(a.size,n)}).attr("height",function(a){return c(a.size,n)}).attr("width",function(a){return c(a.size,n)})}return e.chart=h,e})},b.barchart=function(d,e){e||(e={}),s(c.bar,e),e.color=e.color||b.pickColor();var g=f;return b.addComponent(function(){var c=b.scalex,f=b.scaley,h=e.width,i=f(0),j=g.select("g.barchart");"auto"===h&&(h=a.round(.8*(b.innerWidth()/d.length))),j.node()||(j=g.append("g").attr("class","barchart")),j.attr("stroke",e.stroke).attr("fill",e.color);var k=j.attr("stroke",e.stroke).attr("fill",e.color).selectAll(".bar").data(d).enter().append("rect").attr("class","bar").attr("x",function(a){return c(a.x)-h/2}).attr("y",function(a){return a.y<0?i:f(a.y)}).attr("height",function(a){return a.y<0?f(a.y)-i:i-f(a.y)}).attr("width",h);return e.radius&&k.attr("rx",e.radius).attr("ry",e.radius),e.chart=j,e})},b.drawXaxis=function(){var a=c.xaxis,e="top"===a.position?0:b.innerHeight();return d(c.xAxis,"x-axis",0,e,a)},b.drawYaxis=function(){var a=b.yaxis(),e=1===a?c.yaxis:c.yaxis2,f="left"===e.position?0:b.innerWidth();return d(b.yAxis(),"y-axis-"+a,f,0,e)},b.setBackground=function(a,c){return q.isObject(c)&&(void 0!==c.opacity&&a.attr("fill-opacity",c.opacity),c=c.color),q.isString(c)&&a.attr("fill",c),b},b.gradient=function(b,c,d){var e=a.select("body").append("svg"),f=e.append("linearGradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%").attr("id",b).attr("gradientUnits","userSpaceOnUse");f.append("stop").attr("offset","0").attr("stop-color",c),f.append("stop").attr("offset","0.5").attr("stop-color",d)},b.encode=function(){return btoa(unescape(encodeURIComponent(g.attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").node().parentNode.innerHTML)))},b.downloadSVG=function(c){var d="data:image/svg+xml;charset=utf-8;base64,"+b.encode();a.select(c.target).attr("href",d)},b.downloadPNG=function(c){function d(b,c){if(c&&200===c.status){var d=JSON.parse(c.responseText);a.xhr(d.url).post(y({input:"upload",file:i},"multipart/form-data"),function(a,b){b&&200===b.status&&(d=JSON.parse(b.responseText),e(d))})}}function e(b){a.xhr(b.url,function(a,c){c&&200===c.status&&(b=JSON.parse(c.responseText),"finished"===b.step?g(b.output):"error"===b.step?f(b):e(b))})}function f(){}function g(b){a.select(c.target).attr("href",b.url+"?inline")}if(n.cloudConvertApiKey){var h={apikey:n.cloudConvertApiKey,inputformat:"svg",outputformat:"png"},i=new Blob(["base64,",b.encode()],{type:"image/svg+xml;charset=utf-8"});a.xhr("https://api.cloudconvert.org/process?"+y(h)).header("content-type","multipart/form-data").post(d)}},b.clear()}),n.viz={},n.createviz=function(b,c,d){var e=[],f=function(b,c){v(b)&&(c=b,b=null),c=r({},f.defaults,c);var g,h={},i=a.dispatch.apply(a,c.events),j=0,k=!1;c.event=i,h.vizType=function(){return f},h.vizName=function(){return f.vizName()},h.paper=function(a){return(a||void 0===g)&&(g&&g.destroy(),g=n.paper(b,c),g.on("refresh",function(){h.refresh()})),g},h.element=function(){return h.paper().element()},h.alpha=function(b){return arguments.length?(b=+b,j?j=b>0?b:0:b>0&&(i.start({type:"start",alpha:j=b}),a.timer(h.tick)),h):j},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.tick=function(){return(j*=.99)<.005?(i.end({type:"end",alpha:j=0}),!0):void i.tick({type:"tick",alpha:j})},h.start=function(){return h.resume()},h.refresh=function(){return g&&"canvas"===g.type()&&this.start(),h},h.loadData=function(b){return c.src&&!k?(k=!0,n.log.info("Giotto loading data from "+c.src),a.json(c.src,function(a,c){k=!1,a||h.setData(c,b)})):void 0},h.setData=function(a,b){c.processData&&(a=c.processData(a)),Object(a)===a&&a.data?r(c,a):c.data=a,b&&b()},h.options=function(){return c},h.xyfunction=n.math.xyfunction,a.rebind(h,i,"on"),d&&d(h,c);for(var l=0;l<e.length;++l)e[l](h,c);if(c.onInit){var m=z(c.onInit);w(m)?m(h,c):n.log.error("Could not locate onInit function "+c.onInit)}return h};return n.viz[b]=f,f.defaults=r({},n.defaults.viz,n.defaults.paper,c),f.vizName=function(){return b},f.plugin=function(a){e.push(a)},f},n.crossfilter=function(a){function b(){if(!n.crossfilter.lib)throw Error("Could not find crossfilter library");c.data=n.crossfilter.lib(a.data),n._.isArray(a.dimensions)&&a.dimensions.forEach(function(a){c.addDimension(a)}),a.callback&&a.callback(c)}var c={dims:{},tolerance:void 0===a.tolerance?n.crossfilter.tolerance:a.tolerance};if(c.addDimension=function(a,b){b||(b=function(b){return b[a]}),c.dims[a]=c.data.dimension(b)},c.reduceDensity=function(a,b,d,e){var f,g=c.dims[a];if(!g)throw Error('Cross filter dimension "'+a+'"" not available. Add it with the addDimension method');void 0===d&&(d=null),void 0===e&&(e=null),f=null===d&&null===e?g.filter():g.filter(function(a){return null!==d&&d>a||null!==e&&a>e?void 0:!0});var h=f.bottom(1/0);if(h.length>c.tolerance*b){var i,j,k,l=n.math.kmeans(),m=[],o=[],p=[],q=h.length/b;for(j=0;j<h.length;j++)o.push([h[j][a]]);for(j=0;b>j;j++)p.push(o[Math.round(j*q)]);l.centroids(p).maxIters(10),o=l.cluster(o).sort(function(a,b){return a.centroid[0]-b.centroid[0]}),o.forEach(function(a){for(i=a.indices[0],k=a.points[0],j=1;j<a.points.length;++j)a.points[j]>k&&(i=a.indices[j],k=a.points[j]);m.push(h[i])}),h=m}return h},void 0===n.crossfilter.lib){if("undefined"==typeof crossfilter)return n.require(["crossfilter"],function(a){n.crossfilter.lib=a||null,b()}),c;n.crossfilter.lib=crossfilter}return b(),c},n.crossfilter.tolerance=1.1,a.canvas.axis=function(){function b(){}var c,d=a.scale.linear(),e=C,f=6,g=6,h=3,i=[10],j=null;return b.scale=function(a){return arguments.length?(d=a,b):d},b.orient=function(a){return arguments.length?(e=a in D?a+"":C,b):e},b.ticks=function(){return arguments.length?(i=arguments,b):i},b.tickValues=function(a){return arguments.length?(j=a,b):j},b.tickFormat=function(a){return arguments.length?(c=a,b):c},b.tickSize=function(a){var c=arguments.length;return c?(f=+a,g=+arguments[c-1],b):f},b.innerTickSize=function(a){return arguments.length?(f=+a,b):f},b.outerTickSize=function(a){return arguments.length?(g=+a,b):g},b.tickPadding=function(a){return arguments.length?(h=+a,b):h},b.tickSubdivide=function(){return arguments.length&&b},b};var C="bottom",D={top:1,right:1,bottom:1,left:1};n.paper.addType("canvas",function(b,c){function d(){var a=b.element();a.selectAll("*").remove(),e=b.element().append("canvas").attr("width",c.size[0]).attr("height",c.size[1])}var e,f=b.clear;c.xAxis=a.canvas.axis(),c.yAxis=[a.canvas.axis(),a.canvas.axis()],b.destroy=function(){e=null,element.selectAll("*").remove()},b.refresh=function(){return d(),b.render(),c.event.refresh({type:"refresh",size:c.size.slice(0)}),b},b.clear=function(){return d(),f()},b.current=function(){return e},b.clear()}),n.createviz("chart",{margin:{top:30,right:30,bottom:30,left:30},chartTypes:["bar","line","point","pie"],line:{show:!0},point:{show:!1},bar:{show:!1},pie:{show:!1}},function(a,b){function c(a,b){return a?void 0===a.show?void 0===b?!0:b:a.show:!1}function d(a,b){return a=void 0===a||null===a?b:a}function e(c,d){return c?d?(f.group({"class":"serie"}),n.log.info("Add new serie to chart"),g.push(c),c.label||(c.label="serie "+g.length),b.chartTypes.forEach(function(d){var e=c[d];void 0===e&&(c[d]=e=b[d]),c[d]=e.show?E[d](a,c.data,e):e}),f.parent(),void 0):(x(c)&&(c={data:c}),f.xyData(c)):void 0}var f=a.paper(),g=[];a.numSeries=function(){return g.length},a.each=function(b){return g.forEach(b),a},a.forEach=a.each,a.addSeries=function(g){var h=[1/0,-1/0],i=[1/0,-1/0],j=0===a.numSeries(),k=[];return g.forEach(function(b){w(b)&&(b=b(a)),b=e(b),b&&(k.push(b),h[0]=Math.min(h[0],b.xrange[0]),h[1]=Math.max(h[1],b.xrange[1]),i[0]=Math.min(i[0],b.yrange[0]),i[1]=Math.max(i[1],b.yrange[1]))}),f.xAxis().scale().domain([d(b.xaxis.min,h[0]),d(b.xaxis.max,h[1])]),f.yAxis().scale().domain([d(b.yaxis.min,i[0]),d(b.yaxis.max,i[1])]),k.forEach(function(a){e(a,!0)}),j&&c(b.xaxis)&&f.drawXaxis(),c(b.yaxis)&&f.drawYaxis(),c(b.yaxis2,!1)&&f.drawYaxis(),a},a.addSerie=function(b){return a.addSeries([b])},a.draw=function(){var c=b.data;return void 0===c&&b.src?a.loadData(a.draw):(n._.isFunction(c)&&(c=c(a)),void(c&&a.addSeries(c)))},a.on("tick.main",function(){a.stop(),a.draw()})});var E={line:function(a,b,c){return a.paper().path(b,c)},point:function(a,b,c){return a.paper().points(b,c)},bar:function(a,b,c){return a.paper().barchart(b,c)},pie:function(a,b,c){return a.paper().pie(b,c)}};n.createviz("force",{theta:.8,friction:.9},function(a,b){function c(a){return a.weight=0,isNaN(a.x)&&(a.x=i.x(Math.random())),isNaN(a.y)&&(a.y=i.y(Math.random())),isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y),a}var d,e,f,g,h,i=a.paper(),j=[],k=[];i.xAxis().scale().domain([0,i.innerWidth()]),i.yAxis().scale().domain([0,i.innerHeight()]),a.nodes=function(b){if(!arguments.length)return j;for(d=null,j=b,g=0;g<j.length;++g)c(j[g]).index=g;return a},a.addNode=function(b){return b.index=j.length,j.push(c(b)),a},a.theta=function(c){return arguments.length?(b.theta=c,a):+b.theta},a.friction=function(c){return arguments.length?(b.friction=c,a):+b.friction},a.quadtree=function(a){return(!f||a)&&(f=i.quadtree()(j)),f},a.addForce=function(a){k.push(a)},a.drawPoints=function(){var a=i.options().colors;for(g=0;g<j.length;g++)j[g].fill=a[g%a.length];return i.points(j)},a.drawQuadTree=function(b){return i.drawQuadTree(a.quadtree,b)},a.on("tick.main",function(){for(f=null,g=0;g<k.length;++g)k[g]();for(e=a.friction(),g=-1;++g<j.length;)h=j[g],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*e,h.y-=(h.py-(h.py=h.y))*e)})}),n.viz.force.plugin(function(a,b){function c(){var c=b.linkDistance,h=b.linkStrength,i=a.nodes();if(d=[],e=[],o.length){for(f=0;f<o.length;++f)g=o[f],"number"==typeof g.source&&(g.source=i[g.source]),"number"==typeof g.target&&(g.target=i[g.target]),++g.source.weight,++g.target.weight;if("function"==typeof c)for(f=0;f<o.length;++f)d[f]=+c.call(a,o[f],f);else for(f=0;f<o.length;++f)d[f]=c;if("function"==typeof h)for(f=0;f<o.length;++f)e[f]=+h.call(a,o[f],f);else for(f=0;f<o.length;++f)e[f]=h}}var d,e,f,g,h,i,j,l,m,o=[];n._.copyMissing({linkStrength:1,linkDistance:20},b),a.linkStrength=function(c){return arguments.length?(b.linkStrength="function"==typeof c?c:+c,a):b.linkStrength},a.linkDistance=function(c){return arguments.length?(b.linkDistance="function"==typeof c?c:+c,a):b.linkDistance},a.addForce(function(){for(d||c(),f=0;f<o.length;++f)g=o[f],h=g.source,i=g.target,j=i.x-h.x,l=i.y-h.y,m=j*j+l*l,m&&(m=b.alpha*e[f]*((m=Math.sqrt(m))-d[f])/m,j*=m,l*=m,i.x-=j*(k=h.weight/(i.weight+h.weight)),i.y-=l*k,h.x+=j*(k=1-k),h.y+=l*k)})}),n.viz.force.plugin(function(a,b){var c,d,e,f;void 0===b.gravity&&(b.gravity=.05),a.gravity=function(c){return arguments.length?(b.gravity=c,a):+b.gravity},a.addForce(function(){if(d=a.alpha()*b.gravity,f=a.nodes(),d){var g=a.paper().x(.5),h=a.paper().y(.5);for(c=0;c<f.length;++c)e=f[c],e.fixed||(e.x+=(g-e.x)*d,e.y+=(h-e.y)*d)}})}),n.viz.force.plugin(function(a,b){function c(){if(a.chargeDistance(b.chargeDistance),g=a.charge(),h=a.nodes(),f=[],"function"==typeof g)for(j=0;j<h.length;++j)f[j]=+g.call(a,h[j],j);else for(j=0;j<h.length;++j)f[j]=g}function d(b){var c=a.theta(),d=c*c;return function(a,c,e,f){if(a.point!==b&&a.charge){var g=a.cx-b.x,h=a.cy-b.y,i=f-c,j=g*g+h*h;if(j>i*i/d)return m>j&&(k=a.charge/j,b.px-=g*k,b.py-=h*k),!0;a.point&&j&&m>j&&(k=a.pointCharge/j,b.px-=g*k,b.py-=h*k)}return!a.charge}}function e(a,b,c){var d=0,f=0;if(a.charge=0,!a.leaf)for(var g,h=a.nodes,i=h.length,j=-1;++j<i;)g=h[j],g&&(e(g,b,c),a.charge+=g.charge,d+=g.charge*g.cx,f+=g.charge*g.cy);if(a.point){a.leaf||(a.point.x+=o.x(Math.random())-o.x(.5),a.point.y+=o.y(Math.random())-o.y(.5));var k=b*c[a.point.index];a.charge+=a.pointCharge=k,d+=k*a.point.x,f+=k*a.point.y}a.cx=a.charge?d/a.charge:0,a.cy=a.charge?f/a.charge:0}var f,g,h,i,j,k,l,m,o=a.paper();n._.copyMissing({charge:-30,chargeDistance:1/0},b),a.charge=function(c){return arguments.length?(b.charge=c,a):"function"==typeof b.charge?b.charge:+b.charge},a.chargeDistance=function(c){return arguments.length?(b.chargeDistance2=+c,m=c*c,a):+b.chargeDistance},a.addForce(function(){if(h=a.nodes(),g=a.charge(),g&&h.length)for(f||c(),e(i=a.quadtree(),a.alpha(),f),j=-1;++j<h.length;)(l=h[j]).fixed||i.visit(d(l))})}),n.createviz("map",{tile:null,center:[41.898582,12.476801],zoom:4,maxZoom:18,zoomControl:!0,wheelZoom:!0},function(a,b){a.start=function(){},a.innerMap=function(){},a.addLayer=function(){},b.tile&&n.viz.map.tileProviders[b.tile](a,b)}).tileProviders={},n.viz.map.tileProviders.leaflet=function(b,c){function d(a,b){var c=e.latLngToLayerPoint(new L.LatLng(b,a));this.stream.point(c.x,c.y)}var e,f=[];b.start=function(){"undefined"==typeof L?(n._.loadCss(n.constants.leaflet),n.require(["leaflet"],function(){b.start()})):(e=new L.map(b.element().node(),{center:c.center,zoom:c.zoom}),c.zoomControl?c.wheelZoom||e.scrollWheelZoom.disable():(e.dragging.disable(),e.touchZoom.disable(),e.doubleClickZoom.disable(),e.scrollWheelZoom.disable(),e.tap&&e.tap.disable()),e.on("viewreset",function(){for(var a=0;a<f.length;++a)f[a]()}),b.resume())},b.innerMap=function(){return e},b.addLayer=function(a,b){e&&L.tileLayer(a,b).addTo(e)},b.addOverlay=function(b,c){var g=a.geo.transform({point:d}),h=a.geo.path().projection(g),i=e?a.select(e.getPanes().overlayPane).append("svg"):null,j=i?i.append("g").attr("class","leaflet-zoom-hide"):null,k=function(){var a=h.bounds(b),d=a[0],e=a[1];i.attr("width",e[0]-d[0]).attr("height",e[1]-d[1]).style("left",d[0]+"px").style("top",d[1]+"px"),j.attr("transform","translate("+-d[0]+","+-d[1]+")"),c&&c(h)};return f.push(k),{element:j,collection:b,path:h,draw:k}}},n.createviz("sunBurst",{labels:!0,addorder:!1,transition:750,scale:"sqrt",initNode:null},function(b,c){function d(){var a=Math.min(u.innerWidth(),u.innerHeight());return 400>a?Math.round(100-.15*(500-a)):100}function e(c){function d(a){return a.x>=c.x&&a.x<c.x+c.dx}if(c!==l){q&&q.transition().attr("opacity",0);var e=k(c);return s=c.depth,t.transition().duration(x).attrTween("d",e).each("end",function(a){c===a&&(b.current=a,b.fire("change"))}),q&&(r=[],p.transition().duration(x).attrTween("d",e).each("end",function(b){b.depth>=s&&d(b)&&j(a.select(this.parentNode).select("text").transition().duration(x).attr("opacity",1))})),!0}}function f(){var d=.5*u.innerWidth(),e=.5*u.innerHeight(),f=a.layout.partition().value(function(a){return a.size}).sort(function(a){return void 0===a.order?a.size:a.order}),i=u.group().attr("transform","translate("+d+","+e+")"),k=i.append("g").attr("class","sunburst");n=Math.min(d,e),m=g(n),s=0,l=c.data;m(0),m(n);if(t=k.selectAll("path").data(f.nodes(l)).enter().append("path").attr("d",z).style("fill",function(a){return w((a.children?a:a.parent).name)}),c.labels){var v=t.data();r=[],o=i.append("g").attr("class","text").selectAll("g").data(v).enter().append("g"),p=o.append("path").attr("d",z).attr("opacity",0).on("click",h),q=o.append("text").text(function(a){return void 0!==c.addorder&&void 0!==a.order?a.order+" - "+a.name:a.name}),j(q)}b.select(c.initNode)||c.event.change({type:"change",viz:b})}function g(b){return"linear"===c.scale?a.scale.linear().range([0,b]):a.scale.sqrt().range([0,b])}function h(d){function e(a){return a.x>=d.x&&a.x<d.x+d.dx}s!==d.depth&&(q&&q.transition().attr("opacity",0),s=d.depth,t.transition().duration(x).attrTween("d",k(d)).each("end",function(a){a.depth===s&&e(a)&&(b.current=a,c.event.change({type:"change",viz:b}))}),q&&(r=[],p.transition().duration(x).attrTween("d",k(d)).each("end",function(b){b.depth>=s&&e(b)&&j(a.select(this.parentNode).select("text").transition().duration(x).attr("opacity",1))})))}function i(a){function b(a){var b=c-a;b>=0&&e>b?(c+=e,d=!0):0>b&&b>-e&&(c-=e-b,d=!0)}for(var c=y(a.x+a.dx/2),d=!0,e=Math.PI/40;d;)d=!1,r.forEach(b);return r.push(c),c}function j(a){var b;return a.attr("x",function(a){return a.depth===s?0:(b=i(a),this.__data__.angle=b,b>Math.PI?-m(a.y):m(a.y))}).attr("dx",function(a){return a.depth===s?0:a.angle>Math.PI?-6:6}).attr("dy",function(a){return a.depth===s?a.depth?40:0:".35em"}).attr("transform",function(a){return b=0,a.depth>s&&(b=a.angle,b>Math.PI&&(b-=Math.PI),b-=Math.PI/2),"rotate("+b/Math.PI*180+")"}).attr("text-anchor",function(a){return b=a.angle,a.depth===s?"middle":b&&b>Math.PI?"end":"start"}).style("font-size",function(a){var b=a.depth-s,c=v;return b?b>0&&(c=Math.max(1.2*c-20*b,30)):c*=1.2,Math.round(c)+"%"})}function k(b){var c=a.interpolate(y.domain(),[b.x,b.x+b.dx]),d=a.interpolate(m.domain(),[b.y,1]),e=a.interpolate(m.range(),[b.y?20:0,n]);return function(a,b){return b?function(){return z(a)}:function(b){return y.domain(c(b)),m.domain(d(b)).range(e(b)),z(a)}}}var l,m,n,o,p,q,r,s,t,u=b.paper(),v=d(),w=a.scale.category20c(),x=+c.transition,y=a.scale.linear().range([0,2*Math.PI]),z=a.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,y(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,y(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,m(a.y))}).outerRadius(function(a){return Math.max(0,m(a.y+a.dy))});b.on("tick.main",function(){return c.data?(f(),void b.alpha(0)):b.loadData()}),b.select=function(a){if(l){var b=c.data;if(a&&a.length)for(var d=0;d<a.length;++d){var f=a[d];if(!b.children)break;for(var g=0;g<=b.children.length;++g)if(b.children[g]&&b.children[g].name===f){b=b.children[g];break}}return e(b)}},b.scale=function(a){return arguments.length?(c.scale!==a&&(c.scale=a,b.resume()),b):c.scale}}),n.createviz("trianglify",{bleed:150,fillOpacity:1,strokeOpacity:1,noiseIntensity:0,gradient:null,cellsize:0,cellpadding:0,x_gradient:null,y_gradient:null},function(a,b){function c(){var c=+b.cellsize,d=(+b.cellpadding,+b.fillOpacity),f=+b.strokeOpacity,g=+b.noiseIntensity,h=a.gradient(b.gradient),i=a.gradient(b.x_gradient)||h,j=a.gradient(b.y_gradient)||h,k=a.paper().clear(),l=k.element(),m=a.paper().size();l.selectAll("*").remove(),e||(e=new Trianglify),e.options.fillOpacity=Math.min(1,Math.max(d,0)),e.options.strokeOpacity=Math.min(1,Math.max(f,0)),e.options.noiseIntensity=Math.min(1,Math.max(g,0)),i&&(e.options.x_gradient=i),j&&(e.options.y_gradient=j),c>0&&(e.options.cellsize=c,e.options.bleed=+attrs.bleed);var n=e.generate(m[0],m[1]),o=l.select(".trianglify-background");if(!o.node()){for(var p=l.node(),q=document.createElement("div"),r=p.childNodes;r.length;)q.appendChild(r[0]);q.className="trianglify-background",p.appendChild(q),o=l.select(".trianglify-background")}o.style("min-height","100%").style("background-image",n.dataUrl)}var d,e;a.gradient=function(a){if(a&&"string"==typeof a){var b=a.split("-");if(2===b.length){var c=Trianglify.colorbrewer[b[0]],d=+b[1];if(c)return c[d]}}},a.on("tick.main",function(){if(void 0===a.Trianglify&&"undefined"==typeof Trianglify){if(!d)return d=!0,n.require(["trianglify"],function(b){d=!1,a.Trianglify=b||null})}else void 0===a.Trianglify&&(a.Trianglify=Trianglify),c(),a.stop()})}),n.paper.svg.plugin("brush",{axis:"x",opacity:.125,fill:"#000"},function(b,c){function d(){b.root().current().classed("selecting",!0),c.brush.start&&c.brush.start()}function e(){c.brush.move&&c.brush.move()}function f(){b.root().current().classed("selecting",!1),c.brush.end&&c.brush.end()}var g,h;b.brush=function(){return h},b.extent=function(a){return arguments.length?void(h&&(h.extent(a),b.render(g))):h?h.extent():null},b.addBrush=function(i){return g?b:(q.isObject(i)&&r(c.brush,i),h=a.svg.brush().on("brushstart",d).on("brush",e).on("brushend",f),g=b.addComponent(function(){if(h){var a=b.root().current(),g=a.select("g.brush");if("x"===c.brush.axis&&h.x(b.xAxis().scale()),g.node())g.call(h);else{c.brush.extent&&h.extent(c.brush.extent),g=a.append("g");var i=g.call(h).selectAll("rect").attr("fill",c.brush.fill).attr("fill-opacity",c.brush.opacity);"x"===c.brush.axis&&(g.attr("class","brush x-brush"),i.attr("y",-6).attr("height",b.innerHeight()+7))}d(),e(),f()}}),h)},b.removeBrush=function(){g=b.removeComponent(g),b.root().current().select("g.brush").remove(),h=null
}}),n.viz.chart.plugin(function(a,b){var c,d,e;b.brush&&(d=b.brush,q.isObject(d)||(d={}),e=r({},d),e.start=function(){d.start&&d.start(a)},e.move=function(){a.each(function(b){var c=a.paper().brush(),d=c.extent();b.point.chart&&b.point.chart.selectAll(".point").classed("selected",function(a){return d[0]<=a.x&&a.x<=d[1]}),b.bar.chart&&b.bar.chart.selectAll(".bar").classed("selected",function(a){return d[0]<=a.x&&a.x<=d[1]})}),d.move&&d.move(a)},e.end=function(){d.end&&d.end(a)}),a.dimension=function(b){return init(),arguments.length?(c=b,a):c},a.on("tick.brush",function(){e&&a.paper().addBrush(e)})}),n.viz.force.plugin(function(a){function b(a,b,c){var d,e,f,g=a.radius+b,h=a.x-g,i=a.x+g,j=a.y-g,k=a.y+g;return function(b,l,m,n,o){return b.point&&b.point!==a&&(d=a.x-b.point.x,e=a.y-b.point.y,f=Math.sqrt(d*d+e*e),g=a.radius+b.point.radius+c,g>f&&(f=.5*(g-f)/f,d*=f,e*=f,a.x+=d,a.y+=e,b.point.x-=d,b.point.y-=e)),l>i||h>n||m>k||j>o}}var c=b;a.collide=function(){for(var b=a.quadtree(!0),d=a.nodes(),e=a.paper(),f=e.xAxis().scale(),g=e.x(.05)-e.x(0),h=f.invert(4)-f.invert(0),i=0;i<d.length;++i)b.visit(c(d[i],g,h))}}),n.paper.svg.plugin("grid",{color:"#333",background:{color:"#c6dbef",opacity:.4},opacity:.3},function(b,c){function d(){g||(c.grid=r({},c.grid,n.defaults.paper.grid),void 0===c.xaxis.grid&&(c.xaxis.grid=!0),void 0===c.yaxis.grid&&(c.yaxis.grid=!0),g=a.svg.axis(),h=a.svg.axis())}function e(){var a=b.root().current().select("rect.grid");a.node()||(a=b.current().insert("rect","*").attr("class","grid").attr("width",b.innerWidth()).attr("height",b.innerHeight())),b.setBackground(a,c.grid.background)}function f(a,d,e,f){var g=b.root().current().select("."+e+"-grid");f?g.node()||(a.scale(d.scale()).ticks(d.ticks()).tickFormat(""),g=b.group().attr("class","grid "+e+"-grid").attr("stroke",c.grid.color).attr("stroke-opacity",c.grid.opacity),c.grid.background&&g.attr("fill",c.grid.backgroundColor),"x"===e?a.tickSize(b.innerHeight(),0,0):a.tickSize(-b.innerWidth(),0,0).orient("left"),b.addComponent(function(){g.call(a)})):g.remove()}var g,h;b.showGrid=function(){return d(),e(),f(g,b.xAxis(),"x",c.xaxis.grid),f(h,b.yAxis(),"y",c.yaxis.grid),b},b.hideGrid=function(){return g&&(f(g,b.xAxis(),"x"),f(h,b.yAxis(),"y")),b},b.xGrid=function(){return d(),g},b.yGrid=function(){return d(),h}}),n.viz.chart.plugin(function(a,b){b.grid=r({show:!1},b.grid),a.showGrid=function(b){return a.paper().showGrid(b),a},a.hideGrid=function(){return a.paper().hideGrid(),a},a.on("tick.grid",function(){b.grid.show?a.showGrid():a.hideGrid()})}),n.paper.svg.plugin("quadtree",{color:"#ccc",opacity:1,width:1,fill:"none",fillOpacity:.5},function(b,c){function d(a,b){return 0>=a?0:a>=b?b:a}function e(a){var c=[],e=b.scalex,f=b.scaley,g=b.innerWidth(),h=b.innerHeight();return a.depth=0,a.visit(function(a,b,i,j,k){a.x1=d(e(b),g),a.y1=d(f(k),h),a.x2=d(e(j),g),a.y2=d(f(i),h),c.push(a);for(var l=0;4>l;l++)a.nodes[l]&&(a.nodes[l].depth=a.depth+1)}),c}b.quadtree=function(){return a.geom.quadtree},b.drawQuadTree=function(a,d){n.extend(c.quadtree,d);var f=b.current(),g=c.quadtree;return b.addComponent(function(){var b=f.select("g.quadtree"),c=a();return b.node()?b.selectAll(".quad-node").remove():b=f.append("g").attr("class","quadtree").attr("stroke",g.color).attr("stroke-width",g.width).attr("stroke-opacity",g.opacity).attr("fill",g.fill).attr("fill-opacity",g.fillOpacity).style("shape-rendering","crispEdges"),b.selectAll(".quad-node").data(e(c)).enter().append("rect").attr("class","quad-node").attr("x",function(a){return a.x1}).attr("y",function(a){return a.y1}).attr("width",function(a){return a.x2-a.x1}).attr("height",function(a){return a.y2-a.y1}),{chart:b}})}}),n.paper.svg.plugin("zoom",{x:!0,y:!0,extent:[1,10]},function(b,c){function d(){e||(e=a.behavior.zoom(),c.zoom=r({},c.zoom,n.defaults.paper.zoom))}var e;b.zoom=function(a){d(),a&&r(c.zoom,a),c.zoom.x&&e.x(b.xAxis().scale()),c.zoom.y&&e.y(b.yAxis().scale()),c.zoom.extent&&e.scaleExtent(c.zoom.extent),e.on("zoom",b.render);var f=b.root().current();f.call(e),b.showGrid()}}),n.viz.chart.plugin(function(a,b){a.on("tick.zoom",function(){b.zoom&&a.paper().zoom(b.zoom)})}),n.math.distances={euclidean:function(a,b){for(var c=0,d=0;d<a.length;d++)c+=Math.pow(b[d]-a[d],2);return Math.sqrt(c)}},n.math.kmeans=function(a,b,c){var d={};return b=b||300,c=c||"euclidean","string"==typeof c&&(c=n.math.distances[c]),d.centroids=function(b){return arguments.length?(a=b,d):a},d.maxIters=function(a){return arguments.length?(b=+a,d):b},d.randomCentroids=function(a,b){var c=a.slice(0);return c.sort(function(){return Math.round(Math.random())-.5}),c.slice(0,b)},d.classify=function(b){var d,e,f=1/0,g=0;for(d=0;d<a.length;d++)e=c(b,a[d]),f>e&&(f=e,g=d);return g},d.cluster=function(c,e){var f,g,h,i=0,j=!0,k=c.length,l=a.length,m=new Array(l);if(l>k)throw Error("Number of points less than the number of clusters in K-means classification");for(;j&&b>i;){for(j=!1,++i,h=0;l>h;++h)m[h]={centroid:a[h],points:[],indices:[]};for(g=0;k>g;g++)h=d.classify(c[g]),m[h].points.push(c[g]),m[h].indices.push(g);for(f=[],h=0;l>h;++h){if(!m[h].points.length){f=d.randomCentroids(c,l);break}f.push(n.math.mean(m[h].points))}for(h=0;l>h;++h)if(f[h]!=a[h]){a=f,j=!0;break}e&&e(m,i)}return m},d},n.math.xyfunction=function(a,b){var c=[];return x(a)&&a.forEach(function(a){c.push([a,b(a)])}),c},n.math.mean=function(a){var b,c,d,e=a[0].slice(0);for(c=1;c<a.length;++c)for(b=a[c],d=0;d<e.length;++d)e[d]+=b[d];for(d=0;d<e.length;++d)e[d]/=a.length;return e};var F=52,G=2<<51,H=21201,I=["d       s       a       m_i","2       1       0       1","3       2       1       1 3","4       3       1       1 3 1","5       3       2       1 1 1","6       4       1       1 1 3 3","7       4       4       1 3 5 13","8       5       2       1 1 5 5 17","9       5       4       1 1 5 5 5","10      5       7       1 1 7 11 1"];return n.math.sobol=function(a){if(1>a||a>H)throw new Error("Out of range dimension");var b,c,d={},e=0,f=[],g=[],h=[];d.next=function(){var b=[];if(0===e)return e++,h.slice();for(var d=1,i=e-1;1==(1&i);)i>>=1,d++;for(c=0;a>c;c++)g[c]^=f[c][d],b[c]=g[c]/G;return e++,b},d.dimension=function(){return a},d.count=function(){return e};var i=[];for(c=0;F>=c;c++)i.push(0);for(c=0;a>c;c++)f[c]=i.slice(),g[c]=0,h[c]=0;if(a>I.length)throw new Error("Out of range dimension");for(b=I,c=1;F>=c;c++)f[0][c]=1<<F-c;for(var j=1;a>j;j++){var k=b[j].split(/\s+/),l=+k[1],m=+k[2],n=[0];for(c=0;l>c;c++)n.push(+k[3+c]);for(c=1;l>=c;c++)f[j][c]=n[c]<<F-c;for(c=l+1;F>=c;c++){f[j][c]=f[j][c-l]^f[j][c-l]>>l;for(var o=1;l-1>=o;o++)f[j][c]^=(m>>l-1-o&1)*f[j][c-o]}}return d},a});