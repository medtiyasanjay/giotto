!function(a){var b;b="object"==typeof module&&module.exports?module.exports:window,"function"==typeof define&&define.amd?define(["d3"],function(){return a(d3,b)}):"object"==typeof module&&module.exports&&a(d3,b)}(function(a,b){"use strict";function c(){}function d(a){return h(a,"width")}function e(a){return h(a,"height")}function f(a){return i(a,"width")}function g(a){return i(a,"height")}function h(a,b){for(var c,d=a.node();d&&"BODY"!==d.tagName&&!(c=d.getBoundingClientRect()[b]);)d=d.parentNode;return c}function i(b,c){for(var d,e=b.node();e&&"BODY"!==e.tagName;){if(d=e.getBoundingClientRect()[c])return a.select(e);e=e.parentNode}}function j(){function a(){b.forEach(function(a){a()})}var b=[];return a.add=function(a){b.push(a)},a}function k(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function l(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}var m={version:"0.1.0",d3:a},n=m;a.giotto=m,n.require=function(a,c){return b.rcfg&&b.rcfg.min&&(a=b.rcfg.min(a)),require(a,c),n},n.vizDefaults={paperType:"svg",resize:!1,resizeDelay:200,onInit:null,autoBuild:!0,events:["build","change"],lines:{interpolate:"basis"}},n.paperDefaults={type:"svg",resizeDelay:200,yaxis:1,width:500,height:400},n.constants={DEFAULT_VIZ_GROUP:"default_viz_group"},n.angular={module:function(a,b,c){return b=b||"giotto",c=c||[],a.module(b,c).directive("jstats",function(){return{link:function(a,b,c){var d=c.mode?+c.mode:1;require(rcfg.min(["stats"]),function(){var c=new Stats;c.setMode(d),a.stats=c,b.append($(c.domElement))})}}})},directive:function(a,b,c,d,e){d=d||"giotto",e=e||[];var f="viz"+b.substring(0,1).toUpperCase()+b.substring(1);e.push(function(){return{restrict:"AE",link:function(a,b,d){var e=b.data(f);if(!e){var g=u(d),h=g.autoBuild;g.autoBuild=!1,g.scope=a,e=new c(b[0],g),b.data(e),(void 0===h||h)&&e.build()}}}}),a.module(d).directive(f,e)},addAll:function(a,b,c,d){n.angular.module(a,b,c),a.forEach(n,function(c,e){n.isviz(c)&&n.angular.directive(a,e,c,b,d)})}};var o=/xyz/.test(function(){})?/\b_super\b/:/.*/,p=function(a,b,c,d){return"function"==typeof c&&"function"==typeof d[b]&&o.test(c)?a.new_attr(b,function(){var a=this._super;this._super=d[b];var e=c.apply(this,arguments);return this._super=a,e}):a.new_attr(b,c)},q=n.Type=function(a){return a.new_class=function(a,b){var c=this,d=a===c,e=d?a:a.prototype;a.initialising=!0;var f=new a;delete a.initialising;for(var g in b)"Metaclass"!==g&&(f[g]=p.call(a,c,g,b[g],e));if(d){for(g in e)void 0===f[g]&&(f[g]=e[g]);return f}var h=function(){!this.constructor.initialising&&this.init&&this.init.apply(this,arguments)};return h.prototype=f,h.prototype.constructor=h,h.extend=a.extend,h},a.new_attr=function(a,b){return b},a.extend=function(b){return a.new_class(this,b)},a}(function(){}),r=n.Class=function(a){return a.__class__=q,a.extend=function(a){var b=a.Metaclass||this.__class__,c=b.new_class(this,a);return c.__class__=b,c},a}(function(){}),s=n.extend=function(){var a=arguments.length,b=arguments[0];if(!b||2>a)return b;for(var c,d=0;++d<a;)if(c=arguments[d],Object(c)===c)for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);return b},t=function(a,b){if(a&&b)for(var c in a)a.hasOwnProperty(c)&&void 0===b[c]&&(b[c]=a[c]);return b},u=function(a){if(a&&"string"==typeof a.options){for(var c=b,d=a.options.split("."),e=0;e<d.length&&(c=c[d[e]],c);++e);"function"==typeof c&&(c=c(n,a)),a=s(a,c)}return a},v=function(a){function b(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function d(a){var d=window.console||{},e=d[a]||d.log||c,f=!1;try{f=!!e.apply}catch(g){}return f?function(){for(var a=[],c=0;c<arguments.length;++c)a.push(b(arguments[c]));return e.apply(d,a)}:function(a,b){e(a,null===b?"":b)}}return{log:d("log"),info:d("info"),warn:d("warn"),error:d("error"),debug:function(){var b=d("debug");return function(){a&&b.apply(self,arguments)}}()}};n.log=v(b.debug),n.xyfunction=function(a,b){var c=[];return y(a)&&a.forEach(function(a){c.push([a,b(a)])}),c};var w=Object.prototype.toString,x=function(a){return"[object Function]"===w.call(a)},y=function(a){return"[object Array]"===w.call(a)};n.paper=function(b,c){var f={},g=s({},c,n.paperDefaults);n.paper.types[g.type](f,b,g),f.type=function(){return g.type},f.element=function(){return b},f.yaxis=function(a){return arguments.length?((1===a||2===a)&&(g.yaxis=a),f):g.yaxis},f.xAxis=function(a){return arguments.length?(g.xAxis=a,f):g.xAxis},f.yAxis=function(a){return arguments.length?(g.yAxis[g.yaxis-1]=a,f):g.yAxis[g.yaxis-1]},f.scalex=function(a){return g.xAxis.scale(a)},f.scaley=function(a){return f.yAxis().scale(a)},f.resize=function(a){g._resizing=!0,a||(a=f.boundingBox()),(g.size[0]!==a[0]||g.size[1]!==a[1])&&(n.log.info("Resizing paper"),g.size=a,f.refresh()),g._resizing=!1},f.boundingBox=function(){var a,b=g.elwidth?d(g.elwidth):g.width;return a=g.height_percentage?b*g.height_percentage:g.elheight?e(g.elheight):g.height,[b,a]},c.resize&&a.select(window).on("resize",function(){g._resizing||(g.resizeDelay?(g._resizing=!0,a.timer(function(){return f.resize(),!0},g.resizeDelay)):this.resize())})},n.paper.types={};var z=function(a){if(y(a)){if(y(a[0])&&2===a[0].length){var b=[];return a.forEach(function(a){b.push({x:a[0],y:a[1]})}),b}return a}};n.paper.types.svg=function(b,c,d){var e=c.append("svg").attr("width",d.width).attr("height",d.height).attr("viewBox","0 0 "+d.width+" "+d.height),f=e;d.xAxis=a.svg.axis(),d.yAxis=[a.svg.axis(),a.svg.axis()],b.group=function(){return f=f.append("g")},b.circle=function(a,b,c){return a=d.scalex(a),b=d.scaley(a),rx=d.scalex(c),f.append("circle").attr("cx",a).attr("cy",b).attr("r",c)},b.rect=function(a,b,c,d,e){var g=f.append("rect").attr("x",a).attr("y",b).attr("width",c).attr("height",d);return e&&g.attr("rx",e).attr("ry",e),g},b.path=function(b){if(y(b)&&(b={data:b}),b&&b.data){t(this.options.lines,b);var c=a.svg.line().interpolate(b.interpolate).x(function(a){return a.x}).y(function(a){return a.y}),d=z(b.data);return f.append("path").datum(d).attr("d",c)}}},n.vizRegistry=function(){function a(a){return a||(a=n.constants.DEFAULT_VIZ_GROUP),b[a]||(b[a]=[]),a}var b={};return{has:function(a){for(var c in b)if(b[c].indexOf(a)>=0)return!0;return!1},register:function(c,d){d=a(d),b[d].push(c)},deregister:function(c,d){d=a(d);for(var e=0;e<b[d].length;e++)if(b[d][e].anchorName()===c.anchorName()){b[d].splice(e,1);break}},clear:function(a){a?delete b[a]:b={}},list:function(a){return a=initializeVisGroup(a),b[a]}}}(),n.registerViz=function(a,b){n.vizRegistry.register(a,b)},n.deregisterViz=function(a,b){n.vizRegistry.deregister(a,b)},n.hasViz=function(a){return n.vizRegistry.has(a)};var A=0,B=n.Viz=r.extend({init:function(b,c){if(c||Object(b)!==b||(c=b,b=null),b||(b=document.createElement("div")),c=s({},n.vizDefaults,this.defaults,c),b=a.select(b),this.element=b,this.log=v(c.debug),this.elwidth=null,this.elheight=null,this.uid=++A,this.dispatch=a.dispatch.apply(a,c.events),this.d3=a,c.width||(c.width=d(b),c.width?this.elwidth=f(b):c.width=400),c.height?"string"==typeof c.height&&c.height.indexOf("%")===c.height.length-1&&(c.height_percentage=.01*parseFloat(c.height),c.height=c.height_percentage*c.width):(c.height=e(b),c.height?this.elheight=g(b):c.height=400),this.attrs=this.getAttributes(c),c.resize){var h=this;null===window.onresize&&(window.onresize=j()),window.onresize.add&&window.onresize.add(function(){h._resize()})}c.onInit&&this._executeCallback(c.onInit),c.autoBuild&&this.build()},_resize:function(){var a,b=this.elwidth?d(this.elwidth):this.attrs.width;if(a=this.attrs.height_percentage?b*this.attrs.height_percentage:this.elheight?e(this.elheight):this.attrs.height,(this.attrs.width!==b||this.attrs.height!==a)&&(this.attrs.width=b,this.attrs.height=a,!this._resizing))if(this.attrs.resizeDelay){var c=this;this._resizing=!0,setTimeout(function(){c.log.info("Resizing visualization"),c.resize(),c._resizing=!1},this.attrs.resizeDelay)}else this.resize()},resize:function(a){a&&(this.attrs.width=a[0],this.attrs.height=a[1]),this.build()},paper:function(){return void 0===this._paper&&(this._paper=n.paper(this.element,this.attrs)),this._paper},svg:function(){return this.element.html(""),this.element.append("svg").attr("width",this.attrs.width).attr("height",this.attrs.height)},canvas:function(){return this.element.html(""),this.element.append("canvas").attr("width",this.attrs.width).attr("height",this.attrs.height).node().getContext("2d")},size:function(){return[this.attrs.width,this.attrs.height]},sy:function(){var a=this.size();return a[1]/a[0]},build:function(a){a&&(this.attrs=s(this.attrs,a)),this.d3build(),this.fire("build")},redraw:function(a){this.build(a)},d3build:function(){},loadData:function(b){var c=this,d=this.attrs.src;return d?a.json(d,function(a,d){a||c.setData(d,b)}):void 0},getAttributes:function(a){return a},setData:function(a,b){this.attrs.processData&&(a=this.attrs.processData(a)),Object(a)===a&&a.data?this.attrs=s(this.attrs,a):this.attrs.data=a,b&&b()},on:function(a,b){return this.dispatch.on(a,b),this},fire:function(a){this.dispatch[a]&&this.dispatch[a].call(this)},_executeCallback:function(a){var c=a;if("string"==typeof a){for(var d=b,e=a.split("."),f=0;f<e.length&&(d=d[e[f]],d);++f);c=d}"function"==typeof c?c.call(this):this.log.error('Cannot execute callback "'+a+'". Not a function')}});n.isviz=function(a){return a!==B&&a.prototype&&a.prototype instanceof B},a.canvas={},a.canvas.axis=function(){function b(b){b.each(function(){var b,m=a.select(this),n=this.__chart__||d,o=this.__chart__=d.copy(),p=null===j?o.ticks?o.ticks.apply(o,i):o.domain():j,q=null===c?o.tickFormat?o.tickFormat.apply(o,i):d3_identity:c,r=m.selectAll(".tick").data(p,o),s=r.enter().insert("g",".domain").attr("class","tick").style("opacity",ε),t=a.transition(r.exit()).style("opacity",ε).remove(),u=a.transition(r.order()).style("opacity",1),v=Math.max(f,0)+h,w=d3_scaleRange(o),x=m.selectAll(".domain").data([0]),y=(x.enter().append("path").attr("class","domain"),a.transition(x));s.append("line"),s.append("text");var z,A,B,C,D=s.select("line"),E=u.select("line"),F=r.select("text").text(q),G=s.select("text"),H=u.select("text"),I="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===e?(b=k,z="x",B="y",A="x2",C="y2",F.attr("dy",0>I?"0em":".71em").style("text-anchor","middle"),y.attr("d","M"+w[0]+","+I*g+"V0H"+w[1]+"V"+I*g)):(b=l,z="y",B="x",A="y2",C="x2",F.attr("dy",".32em").style("text-anchor",0>I?"end":"start"),y.attr("d","M"+I*g+","+w[0]+"H0V"+w[1]+"H"+I*g)),D.attr(C,I*f),G.attr(B,I*v),E.attr(A,0).attr(C,I*f),H.attr(z,0).attr(B,I*v),o.rangeBand){var J=o,K=J.rangeBand()/2;n=o=function(a){return J(a)+K}}else n.rangeBand?n=o:t.call(b,o,n);s.call(b,n,o),u.call(b,o,o)})}var c,d=a.scale.linear(),e=C,f=6,g=6,h=3,i=[10],j=null;return b.scale=function(a){return arguments.length?(d=a,b):d},b.orient=function(a){return arguments.length?(e=a in D?a+"":C,b):e},b.ticks=function(){return arguments.length?(i=arguments,b):i},b.tickValues=function(a){return arguments.length?(j=a,b):j},b.tickFormat=function(a){return arguments.length?(c=a,b):c},b.tickSize=function(a){var c=arguments.length;return c?(f=+a,g=+arguments[c-1],b):f},b.innerTickSize=function(a){return arguments.length?(f=+a,b):f},b.outerTickSize=function(a){return arguments.length?(g=+a,b):g},b.tickPadding=function(a){return arguments.length?(h=+a,b):h},b.tickSubdivide=function(){return arguments.length&&b},b};var C="bottom",D={top:1,right:1,bottom:1,left:1};return n.paper.types.canvas=function(b,c,d){{var e=c.append("canvas").attr("width",d.width).attr("height",d.height);e.node().getContext("2d")}d.yaxis=1,d.xAxis=a.canvas.axis(),d.yAxis=[a.canvas.axis(),a.canvas.axis()]},n.C3=B.extend({c3opts:["data","axis","grid","region","legend","tooltip","subchart","zoom","point","line","bar","pie","donut"],init:function(a,b){b||Object(a)!==a||(b=a,a=null),b&&(b.resize=!1),this._super(a,b)},d3build:function(){var a=this,b=this.attrs;if(!this.c3)return require(["c3"],function(b){a.c3=b,a.d3build()});if(!b.data)return this.loadData(function(){a.d3build()});var c={bindto:this.element.node(),size:{width:this.elwidth?null:b.width,height:this.elheight?null:b.height}};a.c3opts.forEach(function(a){b[a]&&(c[a]=b[a])});this.c3.generate(c)}}),n.Force=B.extend({d3build:function(){function b(a){var b=a.radius+16,c=a.x-b,d=a.x+b,e=a.y-b,f=a.y+b;return function(b,g,h,i,j){if(b.point&&b.point!==a){var k=a.x-b.point.x,l=a.y-b.point.y,m=Math.sqrt(k*k+l*l),n=a.radius+b.point.radius;n>m&&(m=(m-n)/m*.5,a.x-=k*=m,a.y-=l*=m,b.point.x+=k,b.point.y+=l)}return g>d||c>i||h>f||e>j}}var c=(this.d3,this.svg()),d=this.attrs,e=d.nodes||100,f=d.minRadius||4,g=d.maxRadius||16,h=d.gravity||.05,i=d.charge||-2e3,j=g>f?g-f:0,k=a.range(e).map(function(){return{radius:Math.random()*j+f}}),l=a.scale.category10(),m=a.layout.force().gravity(h).charge(function(a,b){return b?0:i}).nodes(k).size(this.size()),n=k[0];n.radius=0,n.fixed=!0,m.start(),c.selectAll("circle").data(k.slice(1)).enter().append("svg:circle").attr("r",function(a){return a.radius-2}).style("fill",function(a,b){return l(b%3)}),m.on("tick",function(){for(var d=a.geom.quadtree(k),e=0,f=k.length;++e<f;)d.visit(b(k[e]));c.selectAll("circle").attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})}),c.on("mousemove",function(){var b=a.mouse(this);n.px=b[0],n.py=b[1],m.resume()}).on("touchmove",function(){var b=a.touches(this);n.px=b[0],n.py=b[1],m.resume()})}}),n.Leaflet=B.extend({defaults:{center:[41.898582,12.476801],zoom:4,maxZoom:18,zoomControl:!0,wheelZoom:!0},getAttributes:function(a){return a.resize=!1,a},d3build:function(){var a=this.attrs,b=this.element.node();if("undefined"==typeof L){var c=this;require(["leaflet"],function(){c.d3build()})}else{var d=this.attrs,e=this.map=new L.map(b,{center:a.center,zoom:a.zoom});d.zoomControl?d.wheelZoom||e.scrollWheelZoom.disable():(e.dragging.disable(),e.touchZoom.disable(),e.doubleClickZoom.disable(),e.scrollWheelZoom.disable(),e.tap&&e.tap.disable()),a.buildMap&&a.buildMap.call(this)}},addLayer:function(a,b){this.map&&L.tileLayer(a,b).addTo(this.map)},addSvgLayer:function(b,c){function d(a,b){var c=g.latLngToLayerPoint(new L.LatLng(b,a));this.stream.point(c.x,c.y)}var e=a.geo.transform({point:d}),f=a.geo.path().projection(e),g=this.map,h=g?a.select(g.getPanes().overlayPane).append("svg"):null,i=h?h.append("g").attr("class","leaflet-zoom-hide"):null;if(g){var j={svg:h,g:i,collection:b,path:f,draw:function(){var a=f.bounds(b),d=a[0],e=a[1];h.attr("width",e[0]-d[0]).attr("height",e[1]-d[1]).style("left",d[0]+"px").style("top",d[1]+"px"),i.attr("transform","translate("+-d[0]+","+-d[1]+")"),c&&c(j)}};return g.on("viewreset",j.draw),j}}}),n.SunBurst=B.extend({defaults:{labels:!0,addorder:!1,padding:10,transition:750,scale:"sqrt",initNode:null},textSize:function(){var a=this.size(),b=Math.min(a[0],a[1]);return 400>b?Math.round(100-.15*(500-b)):100},select:function(a){if(this.current){var b=this.attrs.data;if(a&&a.length)for(var c=0;c<a.length;++c){var d=a[c];if(!b.children)break;for(var e=0;e<=b.children.length;++e)if(b.children[e]&&b.children[e].name===d){b=b.children[e];break}}return this._select(b)}},d3build:function(){function b(b){return"log"===m.scale?a.scale.log().range([1,b]):"linear"===m.scale?a.scale.linear().range([0,b]):a.scale.sqrt().range([0,b])}function c(b){function c(a){return a.x>=b.x&&a.x<b.x+b.dx}A!==b.depth&&(j&&j.transition().attr("opacity",0),A=b.depth,C.transition().duration(q).attrTween("d",f(b)).each("end",function(a){a.depth===A&&c(a)&&(g.current=a,g.fire("change"))}),j&&(k=[],i.transition().duration(q).attrTween("d",f(b)).each("end",function(b){b.depth>=A&&c(b)&&e(a.select(this.parentNode).select("text").transition().duration(q).attr("opacity",1))})))}function d(a){function b(a){var b=c-a;b>=0&&e>b?(c+=e,d=!0):0>b&&b>-e&&(c-=e-b,d=!0)}for(var c=y(a.x+a.dx/2),d=!0,e=Math.PI/40;d;)d=!1,k.forEach(b);return k.push(c),c}function e(a){var b;return a.attr("x",function(a){return a.depth===A?0:(b=d(a),this.__data__.angle=b,b>Math.PI?-z(a.y):z(a.y))}).attr("dx",function(a){return a.depth===A?0:a.angle>Math.PI?-6:6}).attr("dy",function(a){return a.depth===A?a.depth?40:0:".35em"}).attr("transform",function(a){return b=0,a.depth>A&&(b=a.angle,b>Math.PI&&(b-=Math.PI),b-=Math.PI/2),"rotate("+b/Math.PI*180+")"}).attr("text-anchor",function(a){return b=a.angle,a.depth===A?"middle":b&&b>Math.PI?"end":"start"}).style("font-size",function(a){var b=a.depth-A,c=o;return b?b>0&&(c=Math.max(1.2*c-20*b,30)):c*=1.2,Math.round(c)+"%"})}function f(b){var c=a.interpolate(y.domain(),[b.x,b.x+b.dx]),d=a.interpolate(z.domain(),[b.y,1]),e=a.interpolate(z.range(),[b.y?20:0,t]);return function(a,b){return b?function(){return B(a)}:function(b){return y.domain(c(b)),z.domain(d(b)).range(e(b)),B(a)}}}var g=this;if(!this.attrs.data)return this.loadData(function(){g.d3build()});var h,i,j,k,l=this.size(),m=this.attrs,n=m.data,o=this.textSize(),p=+m.padding,q=+m.transition,r=l[0]/2,s=l[1]/2,t=Math.min(r,s)-p,u=a.layout.partition().value(function(a){return a.size}).sort(function(a){return void 0===a.order?a.size:a.order}),v=this.svg().append("g").attr("transform","translate("+r+","+s+")"),w=v.append("g").attr("class","sunburst"),x=a.scale.category20c(),y=a.scale.linear().range([0,2*Math.PI]),z=b(t),A=0,B=a.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,y(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,y(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,z(a.y))}).outerRadius(function(a){return Math.max(0,z(a.y+a.dy))}),C=w.selectAll("path").data(u.nodes(n)).enter().append("path").attr("d",B).style("fill",function(a){return x((a.children?a:a.parent).name)});if(this.attrs.labels){var D=C.data();k=[],h=v.append("g").attr("class","text").selectAll("g").data(D).enter().append("g"),i=h.append("path").attr("d",B).attr("opacity",0).on("click",c),j=h.append("text").text(function(a){return void 0!==m.addorder&&void 0!==a.order?a.order+" - "+a.name:a.name}),e(j)}this._select=function(b){function c(a){return a.x>=b.x&&a.x<b.x+b.dx}if(b!==this.current){j&&j.transition().attr("opacity",0);var d=f(b);return A=b.depth,C.transition().duration(q).attrTween("d",d).each("end",function(a){b===a&&(g.current=a,g.fire("change"))}),j&&(k=[],i.transition().duration(q).attrTween("d",d).each("end",function(b){b.depth>=A&&c(b)&&e(a.select(this.parentNode).select("text").transition().duration(q).attr("opacity",1))})),!0}},this.current=n,this.select(this.attrs.initNode)||this.fire("change")}}),n.Trianglify=B.extend({defaults:{bleed:150,fillOpacity:1,strokeOpacity:1,noiseIntensity:0,gradient:null,x_gradient:null,y_gradient:null},d3build:function(){if(void 0===this.Trianglify&&"undefined"==typeof Trianglify){var a=this;return n.require(["trianglify"],function(b){a.Trianglify=b||null,a.d3build()})}void 0===this.Trianglify&&(this.Trianglify=Trianglify);var b=this._t,c=this.attrs,d=c.cellsize?+c.cellsize:0,e=(c.cellpadding?+c.cellpadding:0,c.fillOpacity?+c.fillOpacity:1),f=c.strokeOpacity?+c.strokeOpacity:1,g=c.noiseIntensity?+c.noiseIntensity:0,h=this.gradient(c.gradient),i=this.gradient(c.x_gradient)||h,j=this.gradient(c.y_gradient)||h;this._t||(this._t=b=new Trianglify),b.options.fillOpacity=Math.min(1,Math.max(e,0)),b.options.strokeOpacity=Math.min(1,Math.max(f,0)),b.options.noiseIntensity=Math.min(1,Math.max(g,0)),i&&(b.options.x_gradient=i),j&&(b.options.y_gradient=j),d>0&&(b.options.cellsize=d,b.options.bleed=+c.bleed);var k=b.generate(this.attrs.width,this.attrs.height),l=this.element.select(".trianglify-background");if(!l.node()){for(var m=this.element.node(),o=document.createElement("div"),p=m.childNodes;p.length;)o.appendChild(p[0]);o.className="trianglify-background",m.appendChild(o),l=this.element.select(".trianglify-background")}l.style("min-height","100%").style("background-image",k.dataUrl)},gradient:function(a){if(a&&"string"==typeof a){var b=a.split("-");if(2===b.length){var c=Trianglify.colorbrewer[b[0]],d=+b[1];if(c)return c[d]}}}}),n.Chart=B.extend({serieDefaults:{lines:{show:!0},points:{show:!0}},defaults:{},svg:function(){var a=this.attrs.width,b=this.attrs.height;return this.element.html(""),this.element.append("svg").attr("width",a).attr("height",b).attr("viewBox","0 0 "+a+" "+b)},build:function(){var a=this,b=this.attrs,c=b.data||[];c.forEach(function(b){x(b)&&(b=b(a)),a.addSerie(b)})},addSerie:function(a){a&&(y(a)&&(a={data:a}),a.data&&(this.log.info("Add new serie to chart"),t(this.serieDefaults,a),a.lines.show&&this.paper().drawLine(a.data,a.lines)))}}),a});